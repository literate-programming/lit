# lit cli

the cli is really lightweight and small in implementation.

at first we check if the first arg is `version`. If it is then print the version of the tool to `stdout`

	package main

	import (
		"fmt"
		"flag"
		"io/ioutil"
		"os"

		"github.com/literate-programming/lit"
	)

	var version = "dev"

	func usage()  {
		fmt.Printf("\n")
		fmt.Printf("  +--------+\n")
		fmt.Printf("  | ---    |\n")
		fmt.Printf("  | ---    |  lit v%s - literate preprocessor\n", version)
		fmt.Printf("  |   ---  |  --- ------ - ---------------------\n")
		fmt.Printf("  |   ---  |\n")
		fmt.Printf("  | ---    |\n")
		fmt.Printf("  +--------+\n")
		fmt.Printf("\n")
		fmt.Printf("  USAGE: lit [flags] <in> <out>\n\n")
		fmt.Printf("  FLAGS:\n")
		flag.PrintDefaults()
		fmt.Printf("\n  EXAMPLE:\n")
		fmt.Printf("  $ lit foo.go.md foo.go\n\n")
		os.Exit(0)
	}

	func main() {
		flagCommentStyle := flag.String("c", "//", "the comment style")
		flagGeneratedInfo := flag.Bool("i", true, "add an information that the code was generated at the top of the file")
		flagNoDocs := flag.Bool("n", false, "cut the docs from the final result")
		flagVersion := flag.Bool("v", false, "print the version and exit")

		flag.Usage = usage
		flag.Parse()

		flagArgs := flag.Args()
		totalArgs := flag.NArg()

		if *flagVersion {
			fmt.Println("v"+version)
			os.Exit(0)
		}
		if totalArgs == 0 {
			usage()
		}

	var err error
	var inputData []byte

read the given filepath and store the data to a variable

	if totalArgs >= 1 {
		inputData, err = ioutil.ReadFile(flagArgs[0])
		if err != nil {
			fmt.Println(err)
			os.Exit(1)
		}
	}

now we can transform the input data

	transformed := lit.Transform(inputData, []byte(*flagCommentStyle+" "), *flagNoDocs)

last step is to write the file back to the given filepath

	if totalArgs == 2 {
		outPath := flagArgs[1]
		var outInfo []byte
		if *flagGeneratedInfo {
			outInfo = []byte("// GENERATED BY LIT v"+version+"; DO NOT EDIT\n\n")
		}
		err := ioutil.WriteFile(outPath, append(outInfo, transformed...), 0777)
		if err != nil {
			fmt.Println(err)
			os.Exit(1)
		}
	} else {
		fmt.Println(string(transformed))
	}

	}
